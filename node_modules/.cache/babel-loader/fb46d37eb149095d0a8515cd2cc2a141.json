{"ast":null,"code":"var _jsxFileName = \"/Users/OviB/Desktop/kite-app/src/components/Main/Main.js\";\nimport React, { useEffect, useState } from 'react';\nimport { useCookies } from 'react-cookie';\nimport axios from 'axios';\nimport * as R from 'ramda';\nimport { environment } from '../../environments/environment';\nimport NavBar from '../NavBar/NavBar';\nimport { Button, Container } from '@material-ui/core';\nimport GoogleMap from '../GoogleMap/GoogleMap';\n\nconst Main = () => {\n  const [cookies] = useCookies(['tokenCookie']);\n  const [userData, setUserData] = useState({});\n  const [spots, setSpots] = useState([]);\n  const [favouriteSpots, setFavouriteSpots] = useState([]);\n  useEffect(() => {\n    axios.get(`${environment.apiPath}/user/${cookies.tokenCookie}`).then(response => {\n      setUserData(response);\n    }).catch(error => {\n      if (error.response) {// toast(\"Oups ! Something went wrong\");\n      }\n    });\n    axios.get(`${environment.apiPath}/favourites`).then(response => {\n      setFavouriteSpots(R.uniq(response.data.map(sport => sport.spot.toString())));\n    }).catch(error => {\n      if (error.response) {// toast(\"Oups ! Something went wrong\");\n      }\n    });\n  }, [cookies]);\n  useEffect(() => {\n    axios.get(`${environment.apiPath}/spot`).then(response => {\n      const spots = response.data.map(spot => R.isEmpty(favouriteSpots.filter(favSpot => favSpot === spot.id)) ? spot : { ...spot,\n        isFavouriteSpot: true\n      });\n      setSpots(spots);\n    }).catch(error => {\n      if (error.response) {// toast(\"Oups ! Something went wrong\");\n      }\n    });\n  }, [favouriteSpots]);\n\n  const handleToggleFavourites = id => {\n    console.log(id);\n    setSpots(spots.map(spot => {\n      if (spot.id === id) {\n        return { ...spot,\n          isFavouriteSpot: !spot.isFavouriteSpot\n        };\n      }\n\n      return spot;\n    }));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"main d-flex flex-wrap justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(NavBar, {\n    userInfo: userData,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Container, {\n    maxWidth: \"xl\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(GoogleMap, {\n    className: \"mt-5\",\n    spots: spots,\n    handleToggleFavourites: handleToggleFavourites,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    className: \"bg-primary h-25\",\n    type: \"submit\",\n    variant: \"contained\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, \"ADD SPOT\")));\n};\n\nexport default Main;","map":{"version":3,"sources":["/Users/OviB/Desktop/kite-app/src/components/Main/Main.js"],"names":["React","useEffect","useState","useCookies","axios","R","environment","NavBar","Button","Container","GoogleMap","Main","cookies","userData","setUserData","spots","setSpots","favouriteSpots","setFavouriteSpots","get","apiPath","tokenCookie","then","response","catch","error","uniq","data","map","sport","spot","toString","isEmpty","filter","favSpot","id","isFavouriteSpot","handleToggleFavourites","console","log"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useCookies } from 'react-cookie';\nimport axios from 'axios';\nimport * as R from 'ramda';\nimport { environment } from '../../environments/environment';\nimport NavBar from '../NavBar/NavBar';\nimport { Button, Container } from '@material-ui/core';\nimport GoogleMap from '../GoogleMap/GoogleMap';\n\nconst Main = () => {\n  const [cookies] = useCookies(['tokenCookie']);\n  const [userData, setUserData] = useState({});\n  const [spots, setSpots] = useState([]);\n  const [favouriteSpots, setFavouriteSpots] = useState([]);\n\n  useEffect(() => {\n    axios\n      .get(`${environment.apiPath}/user/${cookies.tokenCookie}`)\n      .then((response) => {\n        setUserData(response);\n      })\n      .catch((error) => {\n        if (error.response) {\n          // toast(\"Oups ! Something went wrong\");\n        }\n      });\n\n    axios\n      .get(`${environment.apiPath}/favourites`)\n      .then((response) => {\n        setFavouriteSpots(R.uniq(response.data.map(sport => sport.spot.toString())))\n      })\n      .catch((error) => {\n        if (error.response) {\n          // toast(\"Oups ! Something went wrong\");\n        }\n    });\n\n  }, [cookies])\n\n  useEffect(() => {\n    axios\n    .get(`${environment.apiPath}/spot`)\n    .then((response) => {\n      const spots = response.data.map(spot => (\n        R.isEmpty(favouriteSpots.filter(favSpot => favSpot === spot.id))\n          ? spot\n          : {...spot, isFavouriteSpot: true}\n      ))\n      setSpots(spots);\n      \n    })\n    .catch((error) => {\n      if (error.response) {\n        // toast(\"Oups ! Something went wrong\");\n      }\n    });\n  }, [favouriteSpots])\n\n  const handleToggleFavourites = (id) => {\n    console.log(id);\n    setSpots(\n      spots.map(spot => {\n        if(spot.id === id) {\n          return { ...spot, isFavouriteSpot: !spot.isFavouriteSpot }\n        }\n        return spot\n      })\n    )\n  }\n\n  return (\n    <div className=\"main d-flex flex-wrap justify-content-center\">\n      <NavBar userInfo={userData} />\n      <Container maxWidth=\"xl\">\n        <GoogleMap className=\"mt-5\" spots={spots} handleToggleFavourites={handleToggleFavourites}/>\n        <Button\n            className=\"bg-primary h-25\"\n            type=\"submit\"\n            variant=\"contained\"\n            color=\"primary\"\n          >\n            ADD SPOT\n        </Button>\n      </Container>\n    </div>\n  );\n};\n\nexport default Main;"]},"metadata":{},"sourceType":"module"}